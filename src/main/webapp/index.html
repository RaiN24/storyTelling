<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<title>StoryTelling123</title>
</head>


<body>

<link rel="stylesheet" href="css/layout.css" charset="utf-8"></link>
<script src="js/initialize.js"></script>
<script src="js/timelineDraw.js"></script>
<script src="js/wordleDraw.js"></script>


<link href="perfect-scrollbar/css/perfect-scrollbar.css" rel="stylesheet">
<script src=".../js/jquery.min.js"></script>
<script src="perfect-scrollbar/js/perfect-scrollbar.jquery.js"></script>
<script src="perfect-scrollbar/js/perfect-scrollbar.js"></script>

       

<link rel="stylesheet" href="search_div/css/jquery-labelauty.css">
<script src="search_div/laydate/laydate.js"></script>
<script src="js/jquery-latest.min.js"></script>
<script src="js/d3.min.js" charset="utf-8"></script>
<script src="js/angular.min.js" charset="utf-8"></script>


 
<div id="naive"></div>
<div id="simple"></div>
<div id="content"></div>
<div id="div_5"></div>

<div class="show"></div> 


<div id="search_div">
          起始日期：<input id="s" class="laydate-icon" onclick="laydate()"><br /><br />
	终止日期：<input id="e" class="laydate-icon" onclick="laydate()"><br /><br />

<h3>最近时间区间选择</h3>
<ul class="dowebok">
	<li><input type="radio" name="radio" data-labelauty="7D" checked="true" onclick="spanChosen(7,[2015,7,1],[2016,11,9])"></li>
	<li><input type="radio" name="radio" data-labelauty="14D" onclick="spanChosen(14,[2015,7,1],[2016,11,9])"></li>
	<li><input type="radio" name="radio" data-labelauty="30D" onclick="spanChosen(30,[2015,7,1],[2016,11,9])"></li><br/>
	<li><input type="radio" name="radio" data-labelauty="3M" onclick="spanChosen(90,[2015,7,1],[2016,11,9])"></li>
	<li><input type="radio" name="radio" data-labelauty="6M" onclick="spanChosen(180,[2015,7,1],[2016,11,9])"></li>
	<li><input type="radio" name="radio" data-labelauty="1Y" onclick="spanChosen(365,[2015,7,1],[2016,11,9])"></li>
	<!--<li><input type="radio" name="radio" disabled data-labelauty="不可用"></li>-->
</ul>

</div>



<script>
;!function(){
laydate({
   elem: '#s'

})
laydate({
   elem: '#e'

})

}();
</script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="search_div/js/jquery-1.8.3.min.js"></script>
<script src="search_div/js/jquery-labelauty.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.js"></script>
<script src="d3.layout.cloud.js"></script>
<script src="json_by_news.js"></script>
<script src="json_by_words.js"></script>
<script>
$(function(){
	$(':input').labelauty();
});
</script>



<script>

var dateOfEvents = [];
var timeNode = [];              //Ӊҹ֣քɕǚ˽ߝ
var month = [31,28,31,30,31,30,31,31,30,31,30,31];
var width = 840;

var begin = [2015,7,1];
var end = [2016,11,9];
var labels1 = [];                         //ÿٶӉҹ֣Ѽ(ք˽ߝքҠۅ
var labels2 = []; 
var values = [];                         //ÿٶӉҹ֣֧ԖÊքƽ߹ֵ
var span = [];


var rects = [];
var texts = [];
var candidate = [];
var csvData = [];
var jsonData;
var flag = [];
var circles = [];
var scaler = 0;
var range=7;
var tmpData=[];
var axisDraw;
var jsonWord = [];
var keyWords;
var wordleText;
var drawColor = [];                  // decide which rectangular to be highlighted
var rectSelected = [];
var rectSelectedFlag = 0;
var wordleSelected = -1;
var textToHighlight = [];

var globalContent = [];

circles.push([]);
circles.push([]);

var fill = d3.scale.category20();

var container = document.querySelector('#content');
Ps.initialize(container);

$("#s").val("2015-07-01");
$("#e").val("2015-09-16");

var tooltip = d3.select("body")
		.append("div")
    	.attr("class","tooltip") //ԃԚcssʨ׃`ҹʽ
    	.attr("opacity",0.0);

var svg1=d3.select("#naive")     
		.append("svg")    
		.attr("width", $(window).width()*0.78)       
		.attr("height", $(window).height()*0.51);		


var svg3=d3.select("#simple")     
			.append("svg")          
			.attr("width", $(window).width()*0.78)       
			.attr("height", $(window).height()*0.09);


var svg_4=d3.select("#div_5").append("svg")
      .attr("width", $(window).width()*0.3)
      .attr("height", $(window).height()*0.385);


var svg_5=d3.select("#content").append("svg")
		.attr("width", $(window).width()*0.2)
		.attr("height", $(window).height()*0.385);


//svg_5.append('rect');
	


d3.csv("data/data2.csv",function(error,csvdata){
	if(error)
		console.log(error);
	csvData = csvdata;
	
	//console.log(csvData);
	
	
});

//var tmpjsonData = new Map();

$.getJSON("/getAllData",function(data){
	
	jsonData = data;
	//jsonData = data;
	//console.log(typeof data);
	//for(var i in data)
		//console.log(i);
	//console.log(jsonData);
	//timelinePict(svg3,0,12,1,jsonData,csvData,0);
	//timeNode = [];
	timelinePict(0,12,7,jsonData,csvData,1);
	
	//timeNode = [];
	//spanArrange(begin,end,1);
	pict_1(svg3,timeNode,values,0,values.length,150,0);
	
	//timeNode = [];
	//spanArrange(begin,end,7);
	
});




$(document).ready(function(){ 
	$(".show").mousedown(function(e){ 
		$(this).css("cursor","move");
		var offset = $(this).offset();
		var x = $(window).width() * 0.06;
		//var y = document.body.clientHeight * 0.55;
		$(document).bind("mousemove",function(ev){ 
			$(".show").stop();
			var _x = ev.pageX - x;
			if(_x < $(window).width()*0.06)_x = $(window).width()*0.06;
			if(_x > $(window).width()*0.70)_x = $(window).width()*0.70;
			var _y = $(window).height() * 0.51;
			scaler = parseInt((_x-$(window).width()*0.06)/ ($(window).width()*0.72)*timeNode.length*0.98);
			//console.log(scaler);
			$(".show").animate({left:_x+"px",top:_y+"px"},10); 
			
			timelinePict(scaler,scaler+$(".show").width()/($(window).width()*0.78)*timeNode.length,7,jsonData,csvData,1);
		}); 

	}); 

	$(document).mouseup(function(){ 
		$(".show").css("cursor","default"); 
		$(this).unbind("mousemove"); 
	}) 
}) 
d3.json("data/json_by_words.json",function(data){
	jsonWord = data;
});


//console.log(json_by_news);


</script>


</body>

